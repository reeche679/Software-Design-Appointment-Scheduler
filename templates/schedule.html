{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/faculty_schedule.css' %}">
<style>
.tab-content {
    display: none;
}
.tab-content.active {
    display: block;
}
.schedule-tabs {
    margin-bottom: 20px;
}
.tab-btn {
    padding: 8px 16px;
    margin-right: 10px;
    border: 1px solid #ddd;
    background-color: #f8f9fa;
    border-radius: 4px;
    cursor: pointer;
}
.tab-btn.active {
    background-color: #dc3545;
    color: white;
    border-color: #dc3545;
}
.time-slot-card.reserved.approved {
    border-left: 6px solid #28a745;
    box-shadow: 0 2px 8px rgba(40,167,69,0.10);
}
.slot-info-item i.text-success {
    color: #28a745 !important;
}
.slot-status.booked.approved-status {
    background: #d4edda;
    color: #155724;
    border-radius: 4px;
    padding: 6px 12px;
    margin-top: 10px;
    font-weight: 600;
    display: inline-block;
}
</style>
{% endblock %}

{% block content %}
<div class="schedule-container">
    <div class="calendar-section">
        <div class="calendar-nav">
            <button class="nav-btn" id="prevMonth">
                <i class="fas fa-chevron-left"></i>
            </button>
            <h2 id="currentMonth">April 2025</h2>
            <button class="nav-btn" id="nextMonth">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div class="calendar-grid">
            <div class="calendar-days">
                <div class="day-header">Sun</div>
                <div class="day-header">Mon</div>
                <div class="day-header">Tue</div>
                <div class="day-header">Wed</div>
                <div class="day-header">Thu</div>
                <div class="day-header">Fri</div>
                <div class="day-header">Sat</div>
            </div>
            <div id="calendarDays" class="calendar-dates"></div>
        </div>
    </div>
    <div class="schedule-content">
        <div class="schedule-tabs">
            <button class="tab-btn active" data-tab="upcoming">Upcoming Appointments</button>
            <button class="tab-btn" data-tab="history">Appointment History</button>
        </div>
        <div class="tab-content active" id="upcoming">
            {% if appointments %}
            <div class="time-slots">
                {% for appointment in appointments %}
                {% if appointment.time_slot.date >= today %}
                <div class="time-slot-card reserved" data-slot-id="{{ appointment.id }}">
                    <div class="slot-info">
                        <div class="slot-info-item">
                            <i class="fas fa-calendar text-success"></i>
                            {{ appointment.time_slot.date|date:"F d, Y" }}
                        </div>
                        <div class="slot-info-item">
                            <i class="fas fa-clock text-success"></i>
                            {{ appointment.time_slot.start_time|time:"g:i A" }} - {{ appointment.time_slot.end_time|time:"g:i A" }}
                        </div>
                        <div class="slot-info-item">
                            <i class="fas fa-door-open text-success"></i>
                            Room {{ appointment.time_slot.room }}
                        </div>
                        <div class="slot-info-item">
                            <i class="fas fa-user text-success"></i>
                            Faculty: {{ appointment.time_slot.faculty.get_full_name }}
                        </div>
                        {% if appointment.reason %}
                        <div class="slot-info-item">
                            <i class="fas fa-info-circle text-success"></i>
                            Purpose: {{ appointment.reason }}
                        </div>
                        {% endif %}
                        <div class="slot-status booked">
                            <i class="fas fa-calendar-check text-success"></i>
                            Status: {{ appointment.status }}
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            {% else %}
            <div class="no-slots">
                <i class="fas fa-calendar-times"></i>
                <p>No upcoming appointments</p>
            </div>
            {% endif %}
        </div>
        <div class="tab-content" id="history">
            {% if appointments %}
            <div class="time-slots">
                {% for appointment in appointments %}
                {% if appointment.time_slot.date < today %}
                <div class="time-slot-card reserved" data-slot-id="{{ appointment.id }}">
                    <div class="slot-info">
                        <div class="slot-info-item">
                            <i class="fas fa-calendar text-success"></i>
                            {{ appointment.time_slot.date|date:"F d, Y" }}
                        </div>
                        <div class="slot-info-item">
                            <i class="fas fa-clock text-success"></i>
                            {{ appointment.time_slot.start_time|time:"g:i A" }} - {{ appointment.time_slot.end_time|time:"g:i A" }}
                        </div>
                        <div class="slot-info-item">
                            <i class="fas fa-door-open text-success"></i>
                            Room {{ appointment.time_slot.room }}
                        </div>
                        <div class="slot-info-item">
                            <i class="fas fa-user text-success"></i>
                            Faculty: {{ appointment.time_slot.faculty.get_full_name }}
                        </div>
                        {% if appointment.reason %}
                        <div class="slot-info-item">
                            <i class="fas fa-info-circle text-success"></i>
                            Purpose: {{ appointment.reason }}
                        </div>
                        {% endif %}
                        <div class="slot-status booked">
                            <i class="fas fa-calendar-check text-success"></i>
                            Status: {{ appointment.status }}
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            {% else %}
            <div class="no-slots">
                <i class="fas fa-calendar-times"></i>
                <p>No appointment history</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
.calendar-container {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.calendar {
    width: 100%;
}

.calendar-header {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    font-weight: 500;
    color: #6c757d;
    border-bottom: 1px solid #dee2e6;
    padding-bottom: 10px;
    margin-bottom: 10px;
}

.calendar-body {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 1px;
    background-color: #dee2e6;
}

.calendar-date {
    background: white;
    min-height: 100px;
    padding: 10px;
    position: relative;
}

.calendar-date.today {
    background-color: #f8f9fa;
}

.date-number {
    font-size: 1.1rem;
    color: #212529;
}

.calendar-date.other-month .date-number {
    color: #adb5bd;
}

#currentMonth {
    font-size: 1.5rem;
    margin: 0;
    color: #212529;
}

.btn-link {
    color: #212529;
    text-decoration: none;
}

.btn-link:hover {
    color: #0056b3;
}

.btn-group .btn {
    padding: 0.375rem 1rem;
}

/* New styles for Upcoming Appointments */
.upcoming-appointments-container {
    background: white;
    border-radius: 8px;
    padding: 30px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.upcoming-title {
    color: #2c3e50;
    font-size: 24px;
    margin-bottom: 20px;
    font-weight: 600;
}

.no-appointments {
    text-align: center;
    color: #6c757d;
    padding: 20px;
    font-size: 16px;
}

.appointments-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.appointment-item {
    border-left: 4px solid #007bff;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 4px;
}

.appointment-item h4 {
    margin: 0;
    color: #2c3e50;
    font-size: 18px;
    font-weight: 500;
}

.appointment-item p {
    margin: 5px 0 0;
    color: #6c757d;
    font-size: 14px;
}
</style>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Calendar functionality
    const currentDate = new Date();
    let currentMonth = currentDate.getMonth();
    let currentYear = currentDate.getFullYear();

    function updateCalendar() {
        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);
        const startingDay = firstDay.getDay();
        const monthLength = lastDay.getDate();

        // Update month display
        const monthNames = ["January", "February", "March", "April", "May", "June",
                          "July", "August", "September", "October", "November", "December"];
        document.getElementById('currentMonth').textContent = `${monthNames[currentMonth]} ${currentYear}`;

        // Clear existing calendar
        const calendarDays = document.getElementById('calendarDays');
        calendarDays.innerHTML = '';

        // Add empty cells for days before start of month
        for (let i = 0; i < startingDay; i++) {
            const emptyDay = document.createElement('div');
            emptyDay.className = 'calendar-day empty';
            calendarDays.appendChild(emptyDay);
        }

        // Add days of the month
        for (let i = 1; i <= monthLength; i++) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            dayElement.innerHTML = `
                <span class="date">${i}</span>
                <div class="day-slots"></div>
            `;
            calendarDays.appendChild(dayElement);
        }
    }

    // Initialize calendar
    updateCalendar();

    // Month navigation
    document.getElementById('prevMonth').addEventListener('click', function() {
        if (currentMonth === 0) {
            currentMonth = 11;
            currentYear--;
        } else {
            currentMonth--;
        }
        updateCalendar();
    });

    document.getElementById('nextMonth').addEventListener('click', function() {
        if (currentMonth === 11) {
            currentMonth = 0;
            currentYear++;
        } else {
            currentMonth++;
        }
        updateCalendar();
    });

    // Tab switching
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabContents = document.querySelectorAll('.tab-content');
    tabBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            // Remove active class from all buttons and contents
            tabBtns.forEach(b => b.classList.remove('active'));
            tabContents.forEach(content => content.classList.remove('active'));
            // Add active class to clicked button and corresponding content
            this.classList.add('active');
            const tabId = this.getAttribute('data-tab');
            document.getElementById(tabId).classList.add('active');
        });
    });
});
</script>
{% endblock %} 